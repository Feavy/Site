(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{250:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(15),i=a.n(l),o=a(17),s=a(19),u=a(20),c=a(23),p=a(21),h=a(22),d=(a(94),a(39)),m=a.n(d),f=a(31),g=a.n(f),v=a(87),b=a.n(v),E=[["1A","1B","2A","2B","3A","3B","4A","4B"],["1A","1B","2A","2B","3A","3B","4A","LP"]],y=["1",,"2",,"3",,"4"],C=["TOUS"],O=["TOUS"],k=["TOUTES"];var w=function(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var t=new Date(Date.UTC(e.getUTCFullYear(),0,1)),a=Math.ceil(((e-t)/864e5+1)/7);return[e.getUTCFullYear(),a]}(new Date),j=w[0],T=w[1],S=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={week:a.props.week,year:a.props.year},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"onWeekChanged",value:function(e){var t=this;if(isNaN(e))this.setState({week:e});else{var a=this.state.year;e<2&&(e+=50,a--),e>51&&(e-=50,a++),this.setState({week:e,year:a}),this.changeTimeout&&clearTimeout(this.changeTimeout),this.changeTimeout=setTimeout(function(){t.props.onWeekChanged({week:t.state.week,year:t.state.year})},500)}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("button",{onClick:function(t){return e.onWeekChanged(e.state.week-1)}},n.a.createElement("i",{class:"material-icons"},"arrow_left")),n.a.createElement(b.a,{className:"input",type:"number",min:"-52",max:"52",value:this.state.week,onChange:function(t){return e.onWeekChanged(Number.parseInt(t.target.value))}}),n.a.createElement("button",{class:"button",onClick:function(t){return e.onWeekChanged(e.state.week+1)}},n.a.createElement("i",{class:"material-icons"},"arrow_right")),n.a.createElement("p",null,"Ann\xe9e : ",n.a.createElement("span",{style:{fontWeight:"bold"}},this.state.year)))}}]),t}(r.Component),F={textAlign:"center"},N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).dayIndexes=["Lun.","Mar.","Mer.","Jeu.","Ven."],a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=1,a=this.props.filter.groups[0].length>0?0:1;return n.a.createElement("div",{id:"schedule"},this.dayIndexes.map(function(t,a){return n.a.createElement("div",null,n.a.createElement("h2",{key:t,style:F},t+" "+e.props.days[a]))}),this.dayIndexes.map(function(t){return n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat("+e.props.filter.groups[a].length+", 1fr)"}},e.props.filter.groups[a].map(function(e){return n.a.createElement("span",{style:{textAlign:"center",overflow:"hidden"},key:"1A"+t+"-gr"+e},E[a][e])}))}),this.props.edt.map(function(a,r){return a.map(function(a,l){return 3==r?n.a.createElement(x,{data:a,isMobile:e.props.isMobile}):n.a.createElement(U,{isFirstTop:0==r||4==r,isFirstLeft:0==l,debug:1==t--,filter:e.props.filter,data:a})})}),this.props.filter.groups[0].length>0&&this.dayIndexes.map(function(t){return n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat("+e.props.filter.groups[1].length+", 1fr)"}},e.props.filter.groups[1].map(function(e){return n.a.createElement("span",{style:{textAlign:"center",overflow:"hidden"},key:"2A"+t+"-gr"+e},E[1][e])}))}))}}]),t}(r.Component),x=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(p.a)(t).call(this,e))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.data;return n.a.createElement("div",{className:"infoCase"},e.length>0&&this.props.isMobile?n.a.createElement("div",{className:"infoButton",onClick:function(){return D.show(e)}},n.a.createElement("span",null,"Infos")):e.map(function(e){return e.url?n.a.createElement("a",{href:e.url,style:{backgroundColor:e.fillColor,color:e.txtColor}},e.txt):n.a.createElement("span",{style:{backgroundColor:e.fillColor,color:e.txtColor}},e.txt)}))}}]),t}(r.Component),U=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).classes=["case"],a.props.isFirstLeft&&a.classes.push("firstLeft"),a.props.isFirstTop&&a.classes.push("firstTop"),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"getOpacity",value:function(e){var t=this.props.filter;return"TOUS"!=t.module&&t.module!=e.module||"TOUS"!=t.profNom&&t.profNom!=e.profNom||"TOUTES"!=t.salle&&t.salle!=e.salle?.3:1}},{key:"render",value:function(){for(var e=this,t=this.props.filter,a=this.props.data,r=0;r<a.length;r++)for(var l=0,i=0;i<a[r].length;i++){var o=a[r][i];o.visible=this.props.filter.groups[r].includes(i);var s=this.props.filter.groups[r].indexOf(i)+1;o.columnStart=s,o.columnEnd=s,o.row=r+1,2==o.row&&0==this.props.filter.groups[0].length&&(o.row=1),0!=i?(o.profNom&&o.visible&&o.profNom==a[r][l].profNom&&(o.columnStart=a[r][l].visible?a[r][l].columnStart:a[r][i].columnStart,a[r][l].visible=!1,o.columnEnd++),o.visible&&(l=i)):o.visible&&(l=i)}return n.a.createElement("div",{className:this.classes.join(" ")},this.props.data.map(function(a,r){return 0!=t.groups[r].length?n.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat("+t.groups[r].length+", 1fr)"}},a.map(function(a,l){return t.groups[r].includes(l)&&a.visible?n.a.createElement("div",{className:"subCase",style:{gridRow:a.row,gridColumnStart:a.columnStart,gridColumnEnd:a.columnEnd,backgroundColor:a.bgColor,color:a.txtColor,opacity:e.getOpacity(a)}},n.a.createElement("div",null,n.a.createElement("span",null,a.module),n.a.createElement("span",null,a.profNom),n.a.createElement("span",null,a.salle))):null})):null}))}}]),t}(r.Component),D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={visible:!1},a.hide=a.hide.bind(Object(o.a)(Object(o.a)(a))),t.instance=Object(o.a)(Object(o.a)(a)),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"show",value:function(e){this.setState({visible:!0,lines:e})}},{key:"hide",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){var e=this.state.lines;return this.state.visible?n.a.createElement("div",{id:"msgBoxBg",onClick:this.hide},n.a.createElement("div",{id:"msgBox"},e.map(function(e,t){return e.url?n.a.createElement("a",{key:"msgBoxLine-"+t,href:e.url,target:"_blank"},e.txt):n.a.createElement("span",{key:"msgBoxLine-"+t},e.txt)}))):null}}],[{key:"show",value:function(e){t.instance.show(e)}}]),t}(r.Component),B=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{id:"filterBox"},n.a.createElement("h3",null,"Filtres : "),n.a.createElement("div",{id:"groups"},n.a.createElement("h4",null,"Groupe : "),n.a.createElement("div",null,"   ",n.a.createElement("h5",null,"1ere ann\xe9e :"),n.a.createElement("div",{className:"groupChooser"},E[0].map(function(t,a){return n.a.createElement("div",{onClick:function(){return e.props.onFilterChanged("group",{promo:0,group:a})},className:e.props.filter.groups[0].includes(a)&&!e.props.isFirstFilter?"selected":""},t)}))),n.a.createElement("div",null,n.a.createElement("h5",null,"2nde ann\xe9e :"),n.a.createElement("div",{className:"groupChooser"},E[1].map(function(t,a){return n.a.createElement("div",{onClick:function(){return e.props.onFilterChanged("group",{promo:1,group:a})},className:e.props.filter.groups[1].includes(a)&&!e.props.isFirstFilter?"selected":""},t)})))),n.a.createElement("div",null,n.a.createElement("h4",null,"Semaine : "),n.a.createElement(S,{week:this.props.filter.week,year:this.props.filter.year,onWeekChanged:function(t){return e.props.onFilterChanged("week",t)}})),n.a.createElement("div",null,n.a.createElement("h4",null,"Professeur : "),n.a.createElement(g.a,{value:this.props.filter.profNom,onChange:function(t){return e.props.onFilterChanged("profNom",t.target.value)}},C.map(function(e){return n.a.createElement(m.a,{value:e},e)}))),n.a.createElement("div",null,n.a.createElement("h4",null,"Salle : "),n.a.createElement(g.a,{value:this.props.filter.salle,onChange:function(t){return e.props.onFilterChanged("salle",t.target.value)}},k.map(function(e){return n.a.createElement(m.a,{value:e},e)}))),n.a.createElement("div",null,n.a.createElement("h4",null,"Module : "),n.a.createElement(g.a,{value:this.props.filter.module,onChange:function(t){return e.props.onFilterChanged("module",t.target.value)}},O.map(function(e){return n.a.createElement(m.a,{value:e},e)}))))}}]),t}(r.Component),A=function(e){function t(e){var a,r;Object(s.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).onFilterChanged=a.onFilterChanged.bind(Object(o.a)(Object(o.a)(a)));var n=localStorage.getItem("lastGroupFilter"),l=localStorage.getItem("backup");return r=n?JSON.parse(n):[[0,1,2,3,4,5,6,7],[0,1,2,3,4,5,6,7]],a.state={isFirstFilter:void 0==n,edtData:[],filter:{week:T,year:j,groups:r,module:"TOUS",profNom:"TOUS",salle:"TOUTES"},isMobile:!1},l&&setTimeout(function(){return a.onDataLoaded(JSON.parse(l),T,j,!0)},0),a.loadData(T,j),a.onWindowResized=a.onWindowResized.bind(Object(o.a)(Object(o.a)(a))),window.addEventListener("resize",a.onWindowResized),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"onWindowResized",value:function(e){var t=window.innerWidth<640;this.state&&this.state.isMobile!=t&&this.setState({isMobile:t})}},{key:"loadData",value:function(e,t){var a=this;fetch("https://edt-relai.yo.fr/fetch.php?infos=1&year="+t+"&week="+e).then(function(r){return r.text().then(function(r){return a.onDataLoaded(r,e,t)})}).catch(function(e){return console.log(e)})}},{key:"onDataLoaded",value:function(e,t,a,r){r||localStorage.setItem("backup",JSON.stringify(e)),C=["TOUS"],O=["TOUS"],k=["TOUTES"];var n=[],l=e.split("\n");l.shift();for(var i=[],o=[],s=0,u=l[s++];u;)i.push(u.split(",")),u=l[s++];for(u=l[++s];u;)o.push(u.split(",")),u=l[s++];for(var c=0;c<7;c++){n[c]=[];for(var p=0;p<5;p++)if(n[c][p]=[],3!=c)for(var h=0;h<2;h++){n[c][p][h]=[];for(var d=0;d<8;d++)n[c][p][h][d]=[]}}for(var m=0;m<i.length;m++){var f=i[m][6],g=i[m][7];g>=3&&g++;var v=Number.parseInt(i[m][4].replace("INFO",""))-1,b=[];if("LP"==i[m][3])v=1,b[0]=7;else if("CE"==i[m][3])b=[0,1,2,3,4,5,6],0==v&&b.push(7);else if(2==i[m][3].length)b[0]=E[0].indexOf(i[m][3]);else{var w=i[m][3].split(""),j=!0,T=!1,S=void 0;try{for(var F,N=w[Symbol.iterator]();!(j=(F=N.next()).done);j=!0){var x=F.value,U=y.indexOf(x);b.push(U),(0==v||1==v&&"4"!=x)&&b.push(U+1)}}catch(_){T=!0,S=_}finally{try{j||null==N.return||N.return()}finally{if(T)throw S}}}for(var D=0;D<b.length;D++){var B=b[D];n[g][f][v][B]={module:i[m][5],profNom:i[m][2],salle:i[m][8],bgColor:i[m][10],txtColor:i[m][11]},C.includes(i[m][2])||C.push(i[m][2]),k.includes(i[m][8])||k.push(i[m][8]),O.includes(i[m][5])||O.push(i[m][5])}}for(var A=0;A<o.length;A++){var I=Number.parseInt(o[A][1]),W=Number.parseInt(o[A][3])||0;n[3][I][W]||(n[3][I][W]={}),n[3][I][W].txt=o[A][4],n[3][I][W].fillColor=o[A][6],n[3][I][W].txtColor=o[A][7],n[3][I][W].url=o[A][5]}for(var M=[],L=new Date(a,0,1+7*(t-1)),J=0;J<5;J++){var R=L.getUTCDate(),z=L.getUTCMonth()+1;R<10&&(R="0"+R),z<10&&(z="0"+z),M[J]=R+"/"+z,L.setUTCDate(L.getUTCDate()+1)}this.setState({edtData:n,days:M}),this.onWindowResized()}},{key:"onFilterChanged",value:function(e,t){var a=this.state.filter,r=this.state.isFirstFilter;if("group"==e){var n=t.promo,l=t.group;if(this.state.isFirstFilter)a.groups[n]=[l],a.groups[1==n?0:1]=[];else{var i=a.groups[n].indexOf(l);i>=0?a.groups[n].splice(i,1):a.groups[n].push(l),a.groups[n].sort()}localStorage.setItem("lastGroupFilter",JSON.stringify(a.groups)),r=!1}else"week"==e?this.loadData(t.week,t.year):a[e]=t;this.setState({filter:a,isFirstFilter:r})}},{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement("h1",{id:"title"},"Emploi du temps - IUT de Blagnac"),n.a.createElement("div",{id:"info"},n.a.createElement("p",null,"Alpha 2.2"),n.a.createElement("a",{href:"https://github.com/Feavy/EDT-React",target:"_blank"},"Code Source")),n.a.createElement(B,{filter:this.state.filter,onFilterChanged:this.onFilterChanged}),this.state.days&&n.a.createElement(N,{filter:this.state.filter,days:this.state.days,isMobile:this.state.isMobile,edt:this.state.edtData}),n.a.createElement(D,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(n.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},89:function(e,t,a){e.exports=a(250)},94:function(e,t,a){}},[[89,2,1]]]);
//# sourceMappingURL=main.ec38424f.chunk.js.map