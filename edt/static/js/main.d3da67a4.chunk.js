(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(8),l=n.n(o),i=n(1),s=n(2),u=n(3),c=n(6),p=n(4),h=n(5),m=(n(15),["1A","1B","2A","2B","3A","3B","4A","4B"]),d=["1",,"2",,"3",,"4"],f=["1A","1B","2A","2B","3A","3B","4A","LP"],g=["TOUS"],v=["TOUS"],b=["TOUTES"];var E=function(e){(e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))).setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var t=new Date(Date.UTC(e.getUTCFullYear(),0,1)),n=Math.ceil(((e-t)/864e5+1)/7);return[e.getUTCFullYear(),n]}(new Date),C=E[0],y=E[1],k=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={value:n.props.value,year:C},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"onWeekChanged",value:function(e){var t=this;if(!isNaN(e)){for(var n=this.state.year;e<2;)e+=50,n--;for(;e>51;)e-=50,n++;this.setState({value:e,year:n}),this.changeTimeout&&clearTimeout(this.changeTimeout),this.changeTimeout=setTimeout(function(){t.props.onWeekChanged({week:t.state.value,year:t.state.year})},500)}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("button",{type:"submit",onClick:function(t){return e.onWeekChanged(e.state.value-1)}},"\u25c0"),r.a.createElement("input",{type:"number",value:this.state.value,onChange:function(t){return e.onWeekChanged(Number.parseInt(t.target.value))}}),r.a.createElement("button",{type:"submit",onClick:function(t){return e.onWeekChanged(e.state.value+1)}},"\u25b6"),r.a.createElement("p",null,"Ann\xe9e : ",r.a.createElement("span",{style:{fontWeight:"bold"}},this.state.year)))}}]),t}(a.Component),O=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).updateData=n.updateData.bind(Object(i.a)(Object(i.a)(n))),n.updateData(),n.classes=["case"],n.props.isFirstLeft&&n.classes.push("firstLeft"),n.props.isFirstTop&&n.classes.push("firstTop"),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"updateData",value:function(){for(var e=this.props.data,t=0;t<e.length;t++)for(var n=0,a=0;a<e[t].length;a++){var r=e[t][a];r.columnStart=a+1,r.visible=this.props.filter.groups[t].includes(a);var o=Math.max(this.props.filter.groups[t].indexOf(a),this.props.filter.groups[0==t?1:0].indexOf(a))+1;r.columnStart=o,r.columnEnd=o,r.row=t+1,2==r.row&&0==this.props.filter.groups[0].length&&(r.row=1),0!=a?(r.profNom&&r.visible&&r.profNom==e[t][n].profNom&&(r.columnStart=e[t][n].visible?e[t][n].columnStart:e[t][a].columnStart,e[t][n].visible=!1,r.columnEnd++),r.visible&&(n=a)):r.visible&&(n=a)}}},{key:"componentWillReceiveProps",value:function(e){this.props=e,this.updateData()}},{key:"render",value:function(){var e=this.props.filter,t=Math.max(this.props.filter.groups[0].length,this.props.filter.groups[1].length);return r.a.createElement("div",{className:this.classes.join(" "),style:{gridTemplateColumns:"repeat("+t+", 1fr)"}},this.props.data.map(function(t,n){return t.map(function(t,a){return e.groups[n].includes(a)&&t.visible?r.a.createElement("div",{style:{gridRow:t.row,gridColumnStart:t.columnStart,gridColumnEnd:t.columnEnd,backgroundColor:t.bgColor,color:t.txtColor,opacity:"TOUS"!=e.module&&e.module!=t.module||"TOUS"!=e.profNom&&e.profNom!=t.profNom||"TOUTES"!=e.salle&&e.salle!=t.salle?.3:1},className:"subCase"},r.a.createElement("div",null,r.a.createElement("span",null,t.module),r.a.createElement("span",null,t.profNom),r.a.createElement("span",null,t.salle))):null})}))}}]),t}(a.Component),w=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).hideMessageBox=n.hideMessageBox.bind(Object(i.a)(Object(i.a)(n)));var a=[];for(var r in n.props.filter.groups[0])a.push(m[r]);return n.state={msgBoxVisible:!1,msgBoxLines:void 0,groupsLabels:a},n.dayIndexes=["Lun.","Mar.","Mer.","Jeu.","Ven."],n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"showMessageBox",value:function(e){console.log("click detected"),this.setState({msgBoxVisible:!0,msgBoxLines:e})}},{key:"hideMessageBox",value:function(){this.setState({msgBoxVisible:!1})}},{key:"render",value:function(){var e=this,t=1,n=this.props.firstDay;return console.log(n),r.a.createElement("div",{id:"schedule"},this.props.days&&this.dayIndexes.map(function(t,n){return r.a.createElement("div",null,r.a.createElement("h2",{key:t,style:{textAlign:"center"}},t+" "+e.props.days[n]))}),this.dayIndexes.map(function(t){return r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat("+e.props.filter.groups[0].length+", 1fr)"}},e.props.filter.groups[0].map(function(e){return r.a.createElement("span",{style:{textAlign:"center",overflow:"hidden"},key:t+"-gr"+e},m[e])}))}),this.props.edt.map(function(n,a){return n.map(function(n,o){return 3==a?r.a.createElement("div",{key:a+";"+o,className:"infoCase"},n.lines.length>0&&e.props.isMobile?r.a.createElement("div",{key:a+";"+o+"-i",className:"infoButton",onClick:function(){return e.showMessageBox(n.lines)}},r.a.createElement("span",null,"Infos")):n.lines.map(function(e){return e.url?r.a.createElement("a",{href:e.url,style:{backgroundColor:e.fillColor,color:e.txtColor}},e.txt):r.a.createElement("span",{style:{backgroundColor:e.fillColor,color:e.txtColor}},e.txt)})):r.a.createElement(O,{isFirstTop:0==a||4==a,isFirstLeft:0==o,debug:1==t--,filter:e.props.filter,data:n})})}),this.state.msgBoxVisible&&r.a.createElement(T,{onClose:this.hideMessageBox,lines:this.state.msgBoxLines}))}}]),t}(a.Component),T=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(p.a)(t).call(this,e))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.lines;return r.a.createElement("div",{id:"msgBoxBg",onClick:this.props.onClose},r.a.createElement("div",{id:"msgBox"},e.map(function(e,t){return e.url?r.a.createElement("a",{key:"msgBoxLine-"+t,href:e.url,target:"_blank"},e.txt):r.a.createElement("span",{key:"msgBoxLine-"+t},e.txt)})))}}]),t}(a.Component),x=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={week:n.props.filter.week},n.currentWeekTimeout=void 0,n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"weekChosen",value:function(e){var t=this;this.setState({week:Number.parseInt(e)}),this.currentWeekTimeout&&clearTimeout(this.currentWeekTimeout),this.currentWeekTimeout=setTimeout(function(){t.props.onFilterChanged("week",t.state.week)},2e3)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"filterBox"},r.a.createElement("h3",null,"Filtres : "),r.a.createElement("div",{id:"groups"},r.a.createElement("h4",null,"Groupe : "),r.a.createElement("div",null,r.a.createElement("h5",null,"1ere ann\xe9e :"),r.a.createElement("div",{className:"groupChooser"},m.map(function(t,n){return r.a.createElement("div",{onClick:function(){return e.props.onFilterChanged("group",{promo:0,group:n})},className:e.props.filter.groups[0].includes(n)&&!e.props.firstFilter?"selected":""},t)}))),r.a.createElement("div",null,r.a.createElement("h5",null,"2nde ann\xe9e :"),r.a.createElement("div",{className:"groupChooser"},f.map(function(t,n){return r.a.createElement("div",{onClick:function(){return e.props.onFilterChanged("group",{promo:1,group:n})},className:e.props.filter.groups[1].includes(n)&&!e.props.firstFilter?"selected":""},t)})))),r.a.createElement("div",null,r.a.createElement("h4",null,"Semaine : "),r.a.createElement(k,{value:this.state.week,onWeekChanged:function(t){return e.props.onFilterChanged("week",t)}})),r.a.createElement("div",null,r.a.createElement("h4",null,"Professeur : "),r.a.createElement("select",{onChange:function(t){return e.props.onFilterChanged("profNom",t.target.value)}},g.map(function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("div",null,r.a.createElement("h4",null,"Salle : "),r.a.createElement("select",{onChange:function(t){return e.props.onFilterChanged("salle",t.target.value)}},b.map(function(e){return r.a.createElement("option",{value:e},e)}))),r.a.createElement("div",null,r.a.createElement("h4",null,"Module : "),r.a.createElement("select",{onChange:function(t){return e.props.onFilterChanged("module",t.target.value)}},v.map(function(e){return r.a.createElement("option",{value:e},e)}))))}}]),t}(a.Component),j=function(e){function t(e){var n,a;Object(s.a)(this,t),(n=Object(c.a)(this,Object(p.a)(t).call(this,e))).onFilterChanged=n.onFilterChanged.bind(Object(i.a)(Object(i.a)(n)));var r=localStorage.getItem("lastGroupFilter");return a=r?JSON.parse(r):[[0,1,2,3,4,5,6,7],[0,1,2,3,4,5,6,7]],n.state={firstFilter:void 0==r,edtData:[],filter:{week:y,year:C,groups:a,module:"TOUS",profNom:"TOUS",salle:"TOUTES"},isMobile:!1},fetch("https://edt-relai.000webhostapp.com/fetch.php?infos=1&year="+C+"&week="+n.state.filter.week).then(function(e){return e.text().then(function(e){return n.onDataLoaded(e,y,C)})}).catch(function(e){return console.log(e)}),n.onWindowResized=n.onWindowResized.bind(Object(i.a)(Object(i.a)(n))),window.addEventListener("resize",n.onWindowResized),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"onWindowResized",value:function(e){var t=window.innerWidth<529;this.state&&this.state.isMobile!=t&&this.setState({isMobile:t})}},{key:"onDataLoaded",value:function(e,t,n){g=["TOUS"],v=["TOUS"],b=["TOUTES"];var a=[],r=e.split("\n");r.shift();for(var o=[],l=[],i=0,s=r[i++];s;)o.push(s.split(",")),s=r[i++];for(s=r[++i];s;)l.push(s.split(",")),s=r[i++];for(var u=0;u<7;u++){a[u]=[];for(var c=0;c<5;c++)if(3!=u){a[u][c]=[];for(var p=0;p<2;p++){a[u][c][p]=[];for(var h=0;h<8;h++)a[u][c][p][h]=[]}}else a[u][c]={lines:[]}}for(var f=0;f<o.length;f++){var E=o[f][6],C=o[f][7];C>=3&&C++;var y=Number.parseInt(o[f][4].replace("INFO",""))-1,k=[];if("LP"==o[f][3])y=1,k[0]=7;else if("CE"==o[f][3])k=[0,1,2,3,4,5,6],0==y&&k.push(7);else if(2==o[f][3].length)k[0]=m.indexOf(o[f][3]);else{var O=o[f][3].split(""),w=!0,T=!1,x=void 0;try{for(var j,S=O[Symbol.iterator]();!(w=(j=S.next()).done);w=!0){var B=j.value,F=d.indexOf(B);k.push(F),(0==y||1==y&&"4"!=B)&&k.push(F+1)}}catch(J){T=!0,x=J}finally{try{w||null==S.return||S.return()}finally{if(T)throw x}}}for(var N=0;N<k.length;N++){var D=k[N];3==C&&console.error("wtf"),a[C][E][y][D]={module:o[f][5],profNom:o[f][2],salle:o[f][8],bgColor:o[f][10],txtColor:o[f][11]},g.includes(o[f][2])||g.push(o[f][2]),b.includes(o[f][8])||b.push(o[f][8]),v.includes(o[f][5])||v.push(o[f][5])}}for(var U=0;U<l.length;U++){var M=Number.parseInt(l[U][1]),W=Number.parseInt(l[U][3])||0;a[3][M].lines[W]||(a[3][M].lines[W]={}),a[3][M].lines[W].txt=l[U][4],a[3][M].lines[W].fillColor=l[U][6],a[3][M].lines[W].txtColor=l[U][7],a[3][M].lines[W].url=l[U][5]}var L=[],I=new Date(n,0,1+7*(t-1));console.log(I);for(var A=0;A<5;A++){var R=I.getUTCDate(),z=I.getUTCMonth()+1;R<10&&(R="0"+R),z<10&&(z="0"+z),L[A]=R+"/"+z,I.setUTCDate(I.getUTCDate()+1)}this.setState({edtData:a,days:L}),this.onWindowResized()}},{key:"onFilterChanged",value:function(e,t){var n=this,a=this.state.filter,r=this.state.firstFilter;if("group"==e){var o=t.promo,l=t.group;if(this.state.firstFilter)a.groups[o]=[l],a.groups[1==o?0:1]=[];else{var i=a.groups[o].indexOf(l);i>=0?a.groups[o].splice(i,1):a.groups[o].push(l),a.groups[o].sort()}localStorage.setItem("lastGroupFilter",JSON.stringify(a.groups)),r=!1}else"week"==e?fetch("https://edt-relai.000webhostapp.com/fetch.php?infos=1&year="+t.year+"&week="+t.week).then(function(e){return e.text().then(function(e){return n.onDataLoaded(e,t.week,t.year)})}).catch(function(e){return console.log(e)}):a[e]=t;this.setState({filter:a,firstFilter:r})}},{key:"render",value:function(){return console.log(this.state.filter),r.a.createElement("div",{className:"App"},r.a.createElement("h1",{id:"title"},"Emploi du temps - IUT de Blagnac"),r.a.createElement("div",{id:"info"},r.a.createElement("p",null,"Alpha 2.0"),r.a.createElement("a",{href:"https://github.com/Feavy/EDT-React",target:"_blank"},"Code Source")),r.a.createElement(x,{filter:this.state.filter,onFilterChanged:this.onFilterChanged}),r.a.createElement(w,{days:this.state.days,isMobile:this.state.isMobile,filter:this.state.filter,edt:this.state.edtData}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,n){e.exports=n(18)}},[[9,2,1]]]);
//# sourceMappingURL=main.d3da67a4.chunk.js.map